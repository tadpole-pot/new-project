<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>everyday experiment</title>
    <style>
        body {
            position: relative;
            height: 100vh;
            background-color: #f0f0f0;
            overflow: hidden;
        }
        .draggable {
            position: absolute;
            width: 100px;
            height: auto;
            cursor: grab;
            user-select: none;
            touch-action: none;
            transition: transform 0.3s ease-in-out; /* 拡大アニメーション */
        }
        .enlarged {
            transform: scale(2); /* 画像を2倍に拡大 */
            z-index: 10; /* ほかの画像の上に表示 */
        }
    </style>
</head>
<body>

    <!-- 画像を配置 -->
    <img id="img1" src="images/image1.png" class="draggable">
    <img id="img2" src="images/image2.png" class="draggable">
    <img id="img3" src="images/image3.gif" class="draggable">

    <script>
        function setInitialPositions() {
            let isMobile = window.innerWidth < 768;

            const mobilePositions = [
                { id: "img1", x: 50, y: 100 },
                { id: "img2", x: 100, y: 300 },
                { id: "img3", x: 150, y: 500 }
            ];

            const desktopPositions = [
                { id: "img1", x: 100, y: 150 },
                { id: "img2", x: 300, y: 200 },
                { id: "img3", x: 500, y: 250 }
            ];

            const positions = isMobile ? mobilePositions : desktopPositions;

            positions.forEach(pos => {
                let img = document.getElementById(pos.id);
                img.style.left = pos.x + "px";
                img.style.top = pos.y + "px";
            });
        }

        setInitialPositions();

        let activeImage = null;
        let offsetX = 0, offsetY = 0;

        function startDrag(event) {
            event.preventDefault();
            activeImage = event.target;

            if (event.type === "mousedown") {
                offsetX = event.clientX - activeImage.offsetLeft;
                offsetY = event.clientY - activeImage.offsetTop;
                document.addEventListener("mousemove", drag);
                document.addEventListener("mouseup", stopDrag);
            } else if (event.type === "touchstart") {
                let touch = event.touches[0];
                offsetX = touch.clientX - activeImage.offsetLeft;
                offsetY = touch.clientY - activeImage.offsetTop;
                document.addEventListener("touchmove", drag, { passive: false });
                document.addEventListener("touchend", stopDrag);
            }

            activeImage.style.cursor = "grabbing";
        }

        function drag(event) {
            event.preventDefault();
            if (!activeImage) return;

            let x, y;
            if (event.type === "mousemove") {
                x = event.clientX;
                y = event.clientY;
            } else if (event.type === "touchmove") {
                let touch = event.touches[0];
                x = touch.clientX;
                y = touch.clientY;
            }

            activeImage.style.left = (x - offsetX) + "px";
            activeImage.style.top = (y - offsetY) + "px";
        }

        function stopDrag() {
            if (activeImage) {
                activeImage.style.cursor = "grab";
                activeImage = null;
            }
            document.removeEventListener("mousemove", drag);
            document.removeEventListener("mouseup", stopDrag);
            document.removeEventListener("touchmove", drag);
            document.removeEventListener("touchend", stopDrag);
        }

        // 画像をクリック（タップ）すると拡大・縮小
        function toggleSize(event) {
            event.stopPropagation(); // ドラッグイベントと干渉しないように
            let img = event.target;

            if (img.classList.contains("enlarged")) {
                img.classList.remove("enlarged"); // 元のサイズに戻す
            } else {
                document.querySelectorAll(".draggable").forEach(el => el.classList.remove("enlarged"));
                img.classList.add("enlarged"); // 画像を拡大
            }
        }

        // イベントリスナーを追加
        document.querySelectorAll(".draggable").forEach(img => {
            img.addEventListener("mousedown", startDrag);
            img.addEventListener("touchstart", startDrag, { passive: false });
            img.addEventListener("click", toggleSize);
            img.addEventListener("touchend", toggleSize);
        });

        // 画面サイズが変わったら、位置をリセット（リロード）
        window.addEventListener("resize", () => {
            location.reload();
        });
    </script>

</body>
</html>
